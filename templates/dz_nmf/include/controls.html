<div class="col-md9">
    <form method="post" action="/upload_file" enctype="multipart/form-data" id="fileForm" class="mb-4">
        <div class="mb-3">
            <div class="row">
                <label for="file" class="form-label">Choose an Excel file (.xlsx or .xls)</label>
                <div class="col-md-8">
                    <input type="file" name="file" class="form-control" id="file" accept=".xlsx, .xls"  {% if not file and 'last_uploaded_file' not in session %} required {% endif %}>
                </div>
            </div>
            <br />
            <button type="submit" class="btn btn-primary">Upload {% if 'last_uploaded_file' in session %}New{% endif %} File</button>
        </div>
    </form>
    {% if file or 'last_uploaded_file' in session %}
        <br />
        <form method="post" action="/dz_nmf/" enctype="multipart/form-data" id="fileForm" class="mb-4">
            <div class="mb-3">
                <h4 style="color:cyan;">File: {{ session["last_uploaded_file"][33:] }}</h4>
                <div class="row">
                    <div class="col-md-4 mt-2">
                        <label>Bandwidth: </label>
                        <label><input type="text" name="kde_bandwidth" value="{{ kde_bandwidth }}"></label>
                    </div>
                </div>
                <div class="row">
                    <label>Select Graphs:</label>
                    <label><input type="checkbox" name="als_graph" value="true" {% if als_graph %}checked{% endif %}> Active Sink Samples</label>
                    <label><input type="checkbox" name="fs_graph" value="true" {% if fs_graph %}checked{% endif %}> Factorized Sources</label>
                    <label><input type="checkbox" name="rs_graph" value="true" {% if rs_graph %}checked{% endif %}> Reconstructed Sources</label>
                    <label><input type="checkbox" name="fr_graph" value="true" {% if fr_graph %}checked{% endif %}> Final Residual vs Rank</label>
                    <label><input type="checkbox" name="ssr_graph" value="true" {% if ssr_graph %}checked{% endif %}> SSR vs Rank</label>
                    <label>Select Matrices:</label>
                    <label><input type="checkbox" name="test_matrix" value="true" {% if test_matrix %}checked{% endif %}> Data Matrix</label>
                </div>
                <button type="submit" class="btn btn-primary">Plot</button>
            </div>
        </form>
    {% endif %}
    {% if loaded_samples %}
        <form>
            <label>
                Loaded Samples:
                <select id="options" name="options" style="width:200px; height:500px" multiple>
                    {% for sample in loaded_samples %}
                        <option name="{{ sample.header }}">{{ sample.header}}</option>
                    {% endfor %}
                </select>
            </label>
            <label>
                Active Samples:
                <select id="options" name="options" style="width:200px; height:500px" multiple>
                    {% for sample in active_samples %}
                        <option name="{{ sample.header }}">{{ sample.header}}</option>
                    {% endfor %}
                </select>
            </label>
        </form>
    {% endif %}
</div>
<br />
<br />


